# TASK-206: 統計表示画面 - テストケース設計

## テスト概要

統計表示画面の全機能を網羅的にテストし、データの正確性とUIの適切な表示を保証する。

## テストカテゴリ

### 1. データ取得・計算テスト

#### TC-001: 基本統計の集計

- **入力**: 5セッションのデータ
- **期待結果**:
  - totalSessions = 5
  - totalPlayTime = 各セッションの合計
  - averageWPM = 全セッションの平均

#### TC-002: 空データの処理

- **入力**: セッションデータなし
- **期待結果**:
  - 全統計が0またはデフォルト値
  - エラーなし

#### TC-003: パフォーマンス統計の計算

- **入力**: WPM=[50, 60, 70], 正確率=[90, 95, 100]
- **期待結果**:
  - averageWPM = 60
  - maxWPM = 70
  - averageAccuracy = 95
  - maxAccuracy = 100

#### TC-004: ストリーク計算

- **入力**: 連続3日プレイ、1日休み、2日プレイ
- **期待結果**:
  - currentStreak = 2
  - longestStreak = 3

### 2. サマリーカード表示テスト

#### TC-005: サマリーカードの表示

- **操作**: ページ読み込み
- **期待結果**:
  - 4-6個のカードが表示
  - 各カードにアイコン、タイトル、数値

#### TC-006: 比較インジケーター

- **入力**: 今日のWPM=60、昨日=50
- **期待結果**:
  - 上昇アイコン表示
  - "+10 (20%)" の表示

#### TC-007: 数値フォーマット

- **入力**: totalPlayTime = 3661000ms
- **期待結果**: "1時間1分" 表示

#### TC-008: ゼロ値の表示

- **入力**: totalSessions = 0
- **期待結果**: "データなし" または "0回"

### 3. グラフ表示テスト

#### TC-009: 折れ線グラフ - WPM推移

- **入力**: 7日分のWPMデータ
- **期待結果**:
  - X軸: 日付ラベル
  - Y軸: WPM値
  - 線が正しくプロット

#### TC-010: 棒グラフ - 日別プレイ時間

- **入力**: 30日分のプレイ時間
- **期待結果**:
  - 各日の棒グラフ
  - ホバーでツールチップ

#### TC-011: 円グラフ - モード別割合

- **入力**: 練習60%、ランダム30%、特定10%
- **期待結果**:
  - 3セグメントの円グラフ
  - パーセンテージ表示

#### TC-012: データなしグラフ

- **入力**: 空配列
- **期待結果**: "データがありません" メッセージ

### 4. フィルタリング機能テスト

#### TC-013: 期間フィルター - 今日

- **操作**: "今日" を選択
- **期待結果**: 今日のデータのみ表示

#### TC-014: 期間フィルター - 週間

- **操作**: "週間" を選択
- **期待結果**: 過去7日間のデータ

#### TC-015: モードフィルター

- **操作**: "練習モード" を選択
- **期待結果**: 練習モードのセッションのみ

#### TC-016: 複合フィルター

- **操作**: "週間" + "ランダムモード"
- **期待結果**: 条件を満たすデータのみ

#### TC-017: フィルターリセット

- **操作**: リセットボタンクリック
- **期待結果**: 全データ表示に戻る

### 5. セッション履歴テスト

#### TC-018: セッション一覧表示

- **入力**: 10セッション
- **期待結果**:
  - テーブル形式で表示
  - 日時、モード、WPM、正確率、スコア

#### TC-019: ソート機能

- **操作**: WPM列ヘッダークリック
- **期待結果**: WPM順にソート

#### TC-020: ページネーション

- **入力**: 50セッション
- **期待結果**:
  - 10件ずつ表示
  - ページ送りボタン

#### TC-021: セッション詳細

- **操作**: セッション行クリック
- **期待結果**: 詳細モーダル表示

### 6. カード別統計テスト

#### TC-022: カード統計表示

- **入力**: 44枚の札データ
- **期待結果**:
  - 各札の統計表示
  - プレイ回数、最速タイム、平均タイム

#### TC-023: 未プレイカード

- **入力**: プレイ回数0の札
- **期待結果**: "未プレイ" 表示

#### TC-024: 最速記録ハイライト

- **入力**: 新記録達成
- **期待結果**: 星アイコンや特別な色

### 7. データ永続化テスト

#### TC-025: セッション保存

- **操作**: ゲーム完了
- **期待結果**: IndexedDBに保存

#### TC-026: データ読み込み

- **操作**: ページリロード
- **期待結果**: 統計が復元

#### TC-027: データエクスポート - JSON

- **操作**: JSONエクスポートボタン
- **期待結果**: 正しいJSON形式でダウンロード

#### TC-028: データエクスポート - CSV

- **操作**: CSVエクスポートボタン
- **期待結果**: 正しいCSV形式でダウンロード

#### TC-029: データインポート

- **操作**: JSONファイルアップロード
- **期待結果**: データが正しく読み込まれる

### 8. レベル・ランクシステムテスト

#### TC-030: レベル計算

- **入力**: totalScore = 10000
- **期待結果**: 適切なレベル表示

#### TC-031: ランク表示

- **入力**: 各種統計値
- **期待結果**: "初心者"/"中級"/"上級" など

#### TC-032: 次レベルまでの表示

- **入力**: 現在レベル5、80%進行
- **期待結果**: プログレスバー表示

### 9. レスポンシブデザインテスト

#### TC-033: モバイル表示

- **画面幅**: 375px
- **期待結果**:
  - 1カラムレイアウト
  - グラフが縦並び

#### TC-034: タブレット表示

- **画面幅**: 768px
- **期待結果**:
  - 2カラムレイアウト
  - グラフが2×2配置

#### TC-035: デスクトップ表示

- **画面幅**: 1280px
- **期待結果**:
  - 3カラムレイアウト
  - グラフが横並び

### 10. アニメーションテスト

#### TC-036: カウントアップアニメーション

- **操作**: ページ読み込み
- **期待結果**: 数値が0から目標値まで増加

#### TC-037: グラフ描画アニメーション

- **操作**: グラフセクション表示
- **期待結果**: 左から右へ描画

#### TC-038: ホバーエフェクト

- **操作**: カードにホバー
- **期待結果**: 影が濃くなる、スケール変化

### 11. パフォーマンステスト

#### TC-039: 初期読み込み時間

- **測定**: ページロード完了まで
- **期待結果**: < 500ms

#### TC-040: 大量データ処理

- **入力**: 1000セッション
- **期待結果**:
  - 表示まで < 1秒
  - UIがフリーズしない

#### TC-041: フィルタリング速度

- **操作**: フィルター変更
- **期待結果**: < 100ms で更新

### 12. エラーハンドリングテスト

#### TC-042: データ取得エラー

- **条件**: IndexedDB接続失敗
- **期待結果**: エラーメッセージ表示

#### TC-043: 不正データの処理

- **入力**: 破損したJSONインポート
- **期待結果**: エラー通知、既存データ保持

#### TC-044: グラフレンダリングエラー

- **条件**: 無効なデータ形式
- **期待結果**: 代替メッセージ表示

### 13. アクセシビリティテスト

#### TC-045: キーボードナビゲーション

- **操作**: Tabキーで移動
- **期待結果**: 全要素にアクセス可能

#### TC-046: スクリーンリーダー対応

- **ツール**: NVDA/JAWS
- **期待結果**: 統計値が正しく読み上げ

#### TC-047: グラフの代替テキスト

- **確認**: グラフのaria-label
- **期待結果**: データの説明文あり

#### TC-048: 高コントラストモード

- **設定**: 高コントラスト有効
- **期待結果**: 視認性確保

### 14. 統合テスト

#### TC-049: 完全なユーザーフロー

- **シナリオ**:
  1. ゲームプレイ
  2. 統計ページ表示
  3. フィルター適用
  4. データエクスポート
- **期待結果**: 全機能正常動作

#### TC-050: 他画面との連携

- **テスト**:
  - メインメニューから遷移
  - ゲーム画面から遷移
  - 設定画面との連携
- **期待結果**: スムーズな遷移

## テスト実装優先順位

### 優先度: 高

1. TC-001〜TC-004（データ計算）
2. TC-005〜TC-008（サマリー表示）
3. TC-025〜TC-026（データ永続化）

### 優先度: 中

1. TC-009〜TC-012（グラフ表示）
2. TC-013〜TC-017（フィルタリング）
3. TC-018〜TC-021（セッション履歴）

### 優先度: 低

1. TC-036〜TC-038（アニメーション）
2. TC-045〜TC-048（アクセシビリティ）
3. TC-027〜TC-029（エクスポート/インポート）

## 自動化戦略

- 単体テスト: Vitest（データ処理ロジック）
- コンポーネントテスト: Testing Library（UI表示）
- E2Eテスト: 手動確認（グラフ、アニメーション）
