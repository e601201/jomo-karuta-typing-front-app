# 犬棒カルタタイピングゲーム 要件定義書

## 概要

犬棒カルタの読み札を使用したWebベースのタイピングゲームアプリケーション。ユーザーのタイピングスキルレベルに応じた難易度設定機能を持ち、楽しみながらタイピングスキルを向上させることを目的とする。

## ユーザストーリー

### ストーリー1: 基本ゲームプレイ

- **である** 一般ユーザー **として**
- **私は** 犬棒カルタの読み札をタイピングして遊ぶ **ことをしたい**
- **そうすることで** 楽しみながらタイピングスキルを向上させることができる

### ストーリー2: 難易度調整

- **である** タイピング初心者 **として**
- **私は** 読み札の一部だけを入力してクリアできる機能 **を使いたい**
- **そうすることで** 自分のレベルに合わせて無理なく練習できる

### ストーリー3: 制限時間設定

- **である** ゲームプレイヤー **として**
- **私は** 制限時間を自分で設定 **したい**
- **そうすることで** 自分のペースに合わせてゲームを楽しめる

### ストーリー4: 設定カスタマイズ

- **である** ユーザー **として**
- **私は** ゲーム設定を保存・変更 **したい**
- **そうすることで** 毎回設定し直す手間を省ける

## 機能要件（EARS記法）

### 通常要件

- REQ-001: システムは犬棒カルタの読み札をランダムに表示しなければならない
- REQ-002: システムはユーザーの入力文字をリアルタイムで判定しなければならない
- REQ-003: システムは正解・不正解を視覚的にフィードバックしなければならない
- REQ-004: システムは制限時間をカウントダウン表示しなければならない
- REQ-005: システムはゲーム終了時に結果を表示しなければならない

### 条件付き要件

- REQ-101: 簡単モードが選択された場合、システムは読み札の一部入力でクリア判定しなければならない
- REQ-102: 標準モードが選択された場合、システムは読み札の完全入力を要求しなければならない
- REQ-103: 制限時間が0になった場合、システムはゲームを終了しなければならない
- REQ-104: 全ての読み札をクリアした場合、システムはゲーム完了処理を実行しなければならない
- REQ-105: 間違った文字が入力された場合、システムはエラー表示を行わなければならない

### 状態要件

- REQ-201: ゲーム進行中の場合、システムは一時停止機能を提供しなければならない
- REQ-202: 設定画面表示中の場合、システムは設定変更を受け付けなければならない
- REQ-203: ゲーム終了後の場合、システムは再開オプションを提供しなければならない

### オプション要件

- REQ-301: システムはハイスコア記録機能を提供してもよい
- REQ-302: システムは音効効果機能を提供してもよい
- REQ-303: システムはキーボードショートカット機能を提供してもよい

### 制約要件

- REQ-401: システムは日本語文字セット（ひらがな、カタカナ、漢字）を正しく処理しなければならない
- REQ-402: システムはブラウザの標準的なキーボード入力イベントを使用しなければならない
- REQ-403: システムはSvelteKit 2のフレームワーク内で動作しなければならない
- REQ-404: システムはローカルストレージを使用して設定を保存しなければならない

## 非機能要件

### パフォーマンス

- NFR-001: キー入力から画面フィードバックまでの遅延は50ms以下でなければならない
- NFR-002: ページ読み込み時間は3秒以内でなければならない
- NFR-003: ゲーム中のCPU使用率は50%以下を維持しなければならない

### ユーザビリティ

- NFR-101: UIは直感的で、初回利用時に説明なしで操作できなければならない
- NFR-102: 文字サイズは読みやすい大きさ（最小16px）でなければならない
- NFR-103: カラーコントラストはアクセシビリティガイドラインに準拠しなければならない

### 互換性

- NFR-201: Chrome、Firefox、Safari、Edgeの最新版で動作しなければならない
- NFR-202: デスクトップ、タブレット、スマートフォンで利用可能でなければならない
- NFR-203: キーボード入力をサポートするデバイスで動作しなければならない

## Edgeケース

### エラー処理

- EDGE-001: ネットワーク接続が不安定な場合、オフラインでも基本機能が動作する
- EDGE-002: ブラウザの戻るボタンが押された場合、ゲーム状態を適切に処理する
- EDGE-003: 無効な文字が入力された場合、エラーメッセージを表示して続行する
- EDGE-004: ローカルストレージが無効な場合、デフォルト設定で動作する

### 境界値

- EDGE-101: 制限時間が1秒未満に設定された場合、最小値1秒に自動調整する
- EDGE-102: 制限時間が3600秒を超えた場合、最大値3600秒に自動調整する
- EDGE-103: 連続で1000文字以上入力された場合、パフォーマンス劣化を防ぐ制御を行う

### ユーザー操作

- EDGE-201: ゲーム中にブラウザタブを切り替えた場合、自動的に一時停止する
- EDGE-202: キーボードが接続されていない場合、適切なエラーメッセージを表示する
- EDGE-203: 同時に複数のキーが押された場合、最初の有効キーのみを処理する

## 受け入れ基準

### 機能テスト

- [ ] 犬棒カルタの読み札が正しく表示される
- [ ] 簡単モード：読み札の一部入力でクリア判定される
- [ ] 標準モード：読み札の完全入力が必要
- [ ] 制限時間のカウントダウンが正確に動作する
- [ ] 制限時間設定が保存・復元される
- [ ] 正解・不正解のフィードバックが適切に表示される
- [ ] ゲーム結果画面が正しく表示される
- [ ] 設定画面で各項目が変更可能
- [ ] 一時停止・再開機能が動作する

### 非機能テスト

- [ ] キー入力レスポンスが50ms以下
- [ ] ページ読み込みが3秒以内
- [ ] 主要ブラウザで正常動作
- [ ] モバイルデバイスで操作可能
- [ ] アクセシビリティガイドライン準拠

### Edgeケーステスト

- [ ] ネットワーク切断時の動作確認
- [ ] 無効文字入力時のエラーハンドリング
- [ ] 境界値での制限時間設定動作
- [ ] ブラウザタブ切り替え時の一時停止
- [ ] ローカルストレージ無効時のフォールバック動作

## 補足情報

### 犬棒カルタについて

犬棒カルタは「いろはカルタ」の一種で、江戸時代から親しまれている伝統的なカルタです。各札には教訓的な意味を持つ短い文章が書かれており、日本の文化や言葉遊びを学ぶのに適しています。

### 技術仕様

- **フレームワーク**: SvelteKit 2 + Svelte 5
- **スタイリング**: Tailwind CSS 4.0
- **言語**: TypeScript
- **データストレージ**: ローカルストレージ
- **デプロイ**: Vercel対応