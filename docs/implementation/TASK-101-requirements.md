# TASK-101: ローマ字入力判定エンジン - 要件定義

## 概要

上毛カルタのひらがな読み札をローマ字入力で正確に判定するエンジンを実装する。
日本語のローマ字入力には複数のパターンが存在するため、全ての一般的な入力パターンに対応する。

## 機能要件

### 1. ひらがな→ローマ字変換

- ひらがな文字列を受け取り、対応するローマ字パターンを生成
- 複数の入力パターンがある場合は全て許容
  - 例: 「し」→ ["shi", "si"]
  - 例: 「つ」→ ["tsu", "tu"]
  - 例: 「じ」→ ["ji", "zi"]

### 2. リアルタイム入力判定

- ユーザーの入力を1文字ずつリアルタイムで判定
- 正解/不正解を即座にフィードバック
- 誤入力時は該当文字のみを削除（REQ-108）

### 3. 複数パターン対応

主要なローマ字入力パターンに対応：

#### 基本パターン

- あ行: a, i, u, e, o
- か行: ka, ki, ku, ke, ko
- さ行: sa, si/shi, su, se, so
- た行: ta, ti/chi, tu/tsu, te, to
- な行: na, ni, nu, ne, no
- は行: ha, hi, hu/fu, he, ho
- ま行: ma, mi, mu, me, mo
- や行: ya, yu, yo
- ら行: ra, ri, ru, re, ro
- わ行: wa, wo, n

#### 濁音・半濁音

- が行: ga, gi, gu, ge, go
- ざ行: za, zi/ji, zu, ze, zo
- だ行: da, di/ji, du/zu, de, do
- ば行: ba, bi, bu, be, bo
- ぱ行: pa, pi, pu, pe, po

#### 拗音（小さい文字）

- きゃ: kya, きゅ: kyu, きょ: kyo
- しゃ: sha/sya, しゅ: shu/syu, しょ: sho/syo
- ちゃ: cha/tya, ちゅ: chu/tyu, ちょ: cho/tyo
- にゃ: nya, にゅ: nyu, にょ: nyo
- ひゃ: hya, ひゅ: hyu, ひょ: hyo
- みゃ: mya, みゅ: myu, みょ: myo
- りゃ: rya, りゅ: ryu, りょ: ryo
- ぎゃ: gya, ぎゅ: gyu, ぎょ: gyo
- じゃ: ja/zya, じゅ: ju/zyu, じょ: jo/zyo
- びゃ: bya, びゅ: byu, びょ: byo
- ぴゃ: pya, ぴゅ: pyu, ぴょ: pyo

#### 促音（っ）

- 次の子音を重ねる
- 例: 「にっぽん」→ "nippon"
- 例: 「がっこう」→ "gakkou"

#### 長音

- 「う」: 前の音に応じてu/ouを許容
- 例: 「こう」→ ["kou", "koo"]
- 例: 「そう」→ ["sou", "soo"]

### 4. 入力状態管理

- 現在の入力位置を管理
- 入力履歴を記録
- 誤入力回数をカウント

## 非機能要件

### パフォーマンス

- キー入力から判定まで30ms以内（NFR-001）
- メモリ使用量を最小限に抑える

### 保守性

- 新しい入力パターンを容易に追加可能
- テスト可能な設計
- 型安全性の確保

## 受け入れ基準

1. 全ひらがな文字の基本パターンが正しく判定される
2. 複数の入力パターンが全て受け入れられる
3. 誤入力時に該当文字のみが削除される
4. 上毛カルタの全44札が正しく入力できる
5. パフォーマンス要件を満たす

## 実装の優先順位

1. 基本的なひらがな→ローマ字変換
2. リアルタイム入力判定
3. 複数パターン対応
4. 促音・拗音・長音の対応
5. パフォーマンス最適化
