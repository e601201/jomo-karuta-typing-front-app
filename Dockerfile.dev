FROM node:20-slim

WORKDIR /app

RUN apt-get update && apt-get install -y curl ca-certificates unzip \
	&& curl -fsSL https://bun.sh/install | bash \
	&& rm -rf /var/lib/apt/lists/*
ENV PATH="/root/.bun/bin:${PATH}"

COPY package.json ./
ARG NPM_REGISTRY=https://registry.npmjs.org/
RUN npm config set registry ${NPM_REGISTRY} \
	&& npm config set fetch-retries 5 \
	&& npm config set fetch-retry-factor 2 \
	&& npm config set fetch-retry-maxtimeout 120000 \
	&& npm config set fetch-retry-mintimeout 20000
RUN --mount=type=cache,target=/root/.npm npm install --no-audit --no-fund

ENV HOST=0.0.0.0
EXPOSE 5173

CMD ["bun", "--bun", "run", "dev", "--", "--host"]


